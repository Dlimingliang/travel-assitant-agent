# 旅游助手

## 1. 项目概述

本项目是基于Python和ReAct架构的开发的旅游助手Agent。该Agent将调用已有模型实现旅游相关的信息查询、行程规划等功能，不涉及模型生成。

这里开发时尽量不考虑架构、扩展能力，只是为了跑通一个agent开发的最小单元。但是开发过程中的问题可以记录下来留给后面去追溯

## 2. 需求分析

### 2.1 核心功能

1. 旅游信息查询
   - 目的地信息: 介绍、开放时间、门票价格
   - 住宿信息: 介绍、价格
   - 餐饮信息: 介绍、价格
   - 天气信息: 天气预报
   - 交通信息: 航班、火车、公交、租车等
2. 行程规划
   - 智能行程生成
   - 行程优化
   - 多日行程规划
3. 用户交互
   - 自然语言交互、多轮对话
   - 地图导航

| 优先级 | 功能模块   | 详细功能        | 必要性 |
|-----|--------|-------------|--------|
| P0  | 旅游信息查询 | 基础景点、住宿信息   | 必需 |
| P0  | 用户交互   | 自然语言理解、多轮对话 | 必需 |
| P0  | 行程规划   | 智能行程生成、优化   | 必需 |
| P1  | 用户交互   | 地图导航        | 重要 |
| P2  | 旅游信息查询 | 交通信息查询      | 可选 |

## 3. 开发流程

### 3.1 需求分析与功能定义

1. 明确Agent的核心功能：
   - 旅游景点信息查询
   - 行程规划建议
   - 酒店/餐厅推荐
   - 天气查询
   - 交通信息查询
   - 预算估算

2. 定义用户交互场景：
   - 用户输入旅游目的地、时间、预算等基本信息
   - Agent提供个性化建议
   - 用户反馈调整建议

3. 确定输入输出格式：
   - 输入：自然语言
   - 输出：结构化JSON或自然语言回复

### 3.2 技术选型

1. 开发语言python
2. llm选择deepseek:v3
3. tool列表
4. agent架构模式:ReAct,不选择开发框架，自定义各种实现
5. web框架:FastAPI

### 3.3 实施计划

| 天数 | 任务 | 详细内容 | 是否完成 |
|------|------|----------|------|
| **第1天** | 项目初始化与环境配置 | 1. 创建标准Python项目结构（`src/`、`tests/`、`config/`等）<br>2. 完善`requirements.txt`（添加fastapi、uvicorn、openai、pydantic等）<br>3. 配置虚拟环境，安装依赖<br>4. 编写基础配置文件（如`.env`管理API密钥）<br>5. 设置日志系统 | ✅    |
| **第2天** | FastAPI基础框架 | 1. 实现FastAPI应用入口（`main.py`）<br>2. 设计健康检查、版本等基础路由<br>3. 添加CORS、中间件等基础配置<br>4. 定义统一的响应模型（`ResponseModel`）<br>5. 编写简单的API文档（Swagger/Redoc） | 未完成  |
| **第3天** | LLM集成与基础Agent结构 | 1. 封装DeepSeek V3 API调用（使用openai SDK）<br>2. 设计Agent基类（包含对话历史、状态等属性）<br>3. 实现简单的消息处理流程（用户输入 → LLM调用 → 返回回复）<br>4. 编写单元测试框架（pytest） | 未开始  |
| **第4天** | ReAct循环设计 | 1. 定义ReAct状态机（Thought、Action、Observation、Final Answer）<br>2. 实现思维链（Chain of Thought）提示模板<br>3. 编写ReAct主循环逻辑（解析LLM输出，决定下一步）<br>4. 添加简单的记忆管理（对话历史缓存） | 未开始  |
| **第5天** | 工具调用机制 | 1. 设计工具注册与发现机制（装饰器或注册表）<br>2. 实现工具调用解析（从LLM输出提取工具名和参数）<br>3. 编写工具执行器（安全调用、异常处理）<br>4. 添加工具结果观察（Observation）生成 | 未开始  |
| **第6天** | 多轮对话与状态持久化 | 1. 实现会话管理（Session ID、对话历史存储）<br>2. 设计状态持久化（可选用内存、Redis或数据库）<br>3. 添加超时、重试等容错机制<br>4. 编写集成测试（模拟多轮对话场景） | 未开始  |
| **第7天** | 优化与调试 | 1. 完善ReAct提示工程（优化思维链模板）<br>2. 添加详细的日志记录（记录每一步决策）<br>3. 实现Agent性能监控（响应时间、工具调用次数）<br>4. 进行端到端测试（模拟真实用户查询） | 未开始  |
| **第8天** | 工具清单设计与基础工具 | 1. 根据需求列出工具清单（天气、景点、住宿、餐饮、交通等）<br>2. 封装基础工具：天气查询（调用免费API如OpenWeather）<br>3. 封装基础工具：景点信息查询（可先用Mock数据或本地JSON）<br>4. 编写工具单元测试 | 未开始  |
| **第9天** | 住宿与餐饮工具 | 1. 封装住宿查询工具（调用Mock数据或第三方API如Booking.com模拟）<br>2. 封装餐饮推荐工具（基于地点、菜系等过滤）<br>3. 设计工具参数验证（使用Pydantic）<br>4. 编写集成测试（Agent调用这些工具） | 未开始  |
| **第10天** | 交通与行程规划工具 | 1. 封装交通查询工具（航班、火车、租车Mock）<br>2. 实现简单的行程规划算法（基于时间、地点、优先级）<br>3. 设计行程优化逻辑（调整顺序、避免冲突）<br>4. 编写行程规划工具 | 未开始  |
| **第11天** | 地图与导航工具（P1） | 1. 集成地图服务（如百度地图API或Leaflet）<br>2. 封装路径规划工具（返回路线、距离、时间）<br>3. 实现简单的地图展示（返回静态图或HTML片段）<br>4. 编写地图工具测试 | 未开始  |
| **第12天** | 工具集成与Agent联调 | 1. 将所有工具注册到Agent工具库<br>2. 优化工具选择策略（基于用户意图自动选择）<br>3. 进行全流程集成测试（模拟完整旅游咨询场景）<br>4. 修复发现的Bug，调整提示词 | 未开始  |

## 开发中的问题

